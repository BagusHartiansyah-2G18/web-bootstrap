<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>Header</title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    
    <link rel='stylesheet' type='text/css'  href='./../library/import.css'>
    <link rel='stylesheet' type='text/css' media='screen' href='main.css'>
    <div id="fileMfc">

    </div>
    <script src='../library/LibMfc.js'></script>
    <script>
      const startmfc=new LibMFC();
      startmfc.startMfc();
      document.write(startmfc.declarationMfc);
    </script>

</head>
<body>
  <main>
    <script>
      // view 3
      // document.write(header_.divider());
      document.write(
        card_.ex1({
          clsCard: "col-8 m-3",
          file:`<svg class="bd-placeholder-img card-img-top" width="100%" height="180" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Placeholder: Image cap" preserveAspectRatio="xMidYMid slice" focusable="false"><Header>Placeholder</Header><rect width="100%" height="100%" fill="#868e96"/><text x="50%" y="50%" fill="#dee2e6" dy=".3em">Image cap</text></svg>`,
          clsHeader:" p-2 bg-light shadow h3",
          htmlHeader:"Example Read Excell",
          clsBody:"",
          tukar:"Bagus H",
          htmlBody:input_.ex2({
                    clsDiv:"mb-3",
                    text:"File Excell",
                    id:"text",
                    tipe:"file",
                    cls:"form-control",
                    attr:` onchange='_selected(this)'`
                  })+
                  `<div id='tabelShow' style="margin-top:40px;">
                  </div>`,
        })
      )

      
    </script>
  </main>
  <script> 
    document.write(startmfc.endBootstrapHTML(2,undefined,"tabel"));

    function _selected(v) {
        _respon([]);
        // idToast="toast";
        // _onModal(_loader());
        // $('#modal').modal("show");
        // _setModalContent(_loader());
        _readExcell(v).then(v=>{
            if(v.exec){
                // $('#modal').modal("hide");
                _respon(v.data);
            }else{
                _toast({msg:"Error while parsing Excel file. See console output for the error stack trace"});
            }
        })
        // $('#modal').modal("hide");
      }
    function _respon(data){
        $('#tabelShow').html(setTabel(data));
        _btabelStart('dataTabel');
      }
    function setTabel(data) {
        kolom_name=_getKeyRay(data);
        return btabel(
        {
            id:"dataTabel",
            class:''
            ,isi:btabelForExcel(
                {
                    data:data
                    ,no:1
                    ,kolom:kolom_name.key
                    ,namaKolom:kolom_name.judul

                })
        });
      }
  </script>
</body>
</html>